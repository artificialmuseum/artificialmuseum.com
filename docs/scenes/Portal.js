import{a9 as i}from"../vendor.js";class t{constructor(t){var{artifact:s,mergeConfig:e,preload:o}=t;this.config=e(s.portal,{in:"inside",out:"clipCube",door:"door",parent:"parent",doorPosition:{x:0,y:0,z:0},doorWidth:1.4,doorHeight:2,cubeSize:4.05,doorZOffset:.05}),this.doorXOffset=this.config.doorWidth/2,this.cubeOffset=this.config.cubeSize/2,this.doorZOffset=.1,this.rotation=1,this.walkedThroughDoor=!1,this.rotationNormal=new i(0,1,0)}afterLoadModel(i){var{engine:t}=i;this.camera=t.camera;var{model:s}=t;this.inside=s.getObjectByName(this.config.in),this.clipCube=s.getObjectByName(this.config.out),this.door=s.getObjectByName(this.config.door),this.parent=s.getObjectByName(this.config.parent)}tick(){var{x:i,y:t,z:s}=this.camera.position,{cubeSize:e,doorHeight:o}=this.config,{clipCube:a,door:h,inside:r,parent:n,doorXOffset:d,cubeOffset:l,doorZOffset:c}=this,f=t<o&&t>0,g=i<d&&i>-d,b=s<0&&s>-c&&g&&f,u=s<0&&s>-e&&i<l&&i>-l;s>0&&s<c&&g&&f?this.walkingIn=!0:u||(this.walkingIn=!1),b?this.walkingOut=!0:u&&(this.walkingOut=!1),u?(this.walkingIn&&(this.hasJustEntered=!0,this.hasJustExited=!1,this.walkingIn=!1),this.hasJustEntered?(a.visible&&(a.visible=!1),h.visible&&(h.visible=!1)):r.visible&&(r.visible=!1),this.walkingOut=!!b):(this.walkingOut&&(this.hasJustEntered=!1,this.hasJustExited=!0,this.walkingOut=!1),this.hasJustExited&&(r.visible||(r.visible=!0),a.visible||(a.visible=!0),h.visible||(h.visible=!0)))}}export{t as default};
