class e{constructor(e){var{artifact:a}=e,{distanceModifier:t=1,distanceThreshold:i=2,minAlpha:r=.1,maxAlpha:s=1}=a;this.distanceModifier=t,this.distanceThreshold=i,this.minAlpha=r,this.maxAlpha=s}beforeLoadModel(e){var{engine:a,preload:t}=e;this.engine=a,this.camera=a.camera;var{scene:i}=t.assets.gltf;this.trigger={},this.hidden={},i.traverse((e=>{if(e.name.startsWith("trigger_")){var a=e.name.replace("trigger_","");this.trigger[a]=e}else if(e.name.startsWith("hidden_")){var t=e.name.replace("hidden_","");this.hidden[t]=e}}))}calculateAlpha(){var e=Object.entries(this.trigger).map((e=>{var[a,t]=e,i=this.distanceThreshold*this.distanceThreshold,r=this.camera.position.distanceToSquared(t.position)-i,s=((100-Math.max(0,r)*this.distanceModifier)/100).toFixed(2);return[a,Math.min(Math.max(this.minAlpha,s),this.maxAlpha)]}));return Object.fromEntries(e)}tick(){var e=this.calculateAlpha();Object.entries(e).map((e=>{var[a,t]=e;this.hidden[a].material.opacity=t}))}}export{e as default};
