import{a1 as e,a2 as i,a3 as t,a4 as a,_ as c}from"./vendor.js";var r,l=new WeakSet;class s{constructor(a){var{clickables:c,clickableChildren:r=!1,engine:s}=a;e(this,l),this.clickables=c,this.clickNodes=c.map((e=>e.node)),this.clickableChildren=r,this.engine=s,this.rotationMatrix=new i,this.raycaster=new t,this.click=this.click.bind(this),this.select=this.select.bind(this)}click(e){var{clickables:i,clickableChildren:t,clickNodes:c}=this;if(!0===i)a(this,l,n).call(this);else{var{raycaster:r}=this,{camera:s,renderer:o}=this.engine,h=e.clientX/o.domElement.clientWidth*2-1,d=-e.clientY/o.domElement.clientHeight*2+1;r.setFromCamera({x:h,y:d},s);var k=r.intersectObjects(c,t);a(this,l,n).call(this,k)}}select(){var e=this;return c((function*(){var{clickables:i,clickableChildren:t,clickNodes:c}=e;if(!0===i)yield a(e,l,n).call(e);else{var{raycaster:r,rotationMatrix:s}=e,{controller:o}=e.engine;s.extractRotation(o.matrixWorld),r.ray.origin.setFromMatrixPosition(o.matrixWorld),r.ray.direction.set(0,0,-1).applyMatrix4(s);var h=r.intersectObjects(c,t);yield a(e,l,n).call(e,h)}}))()}}function n(){return(r=r||c((function*(){var e=[];return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach((i=>{var{object:t}=i,a=this.clickables.find((e=>e.node.name===t.name));a&&e.push(a)})),yield this.engine.onTouch(e),e}))).apply(this,arguments)}export{s as Controls};
