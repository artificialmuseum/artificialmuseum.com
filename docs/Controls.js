import{be as e,bf as i,ae as t,bg as c,c as r}from"./vendor.js";var a=new WeakSet;class l{constructor(c){var{clickables:r,clickableChildren:l=!1,engine:s}=c;e(this,a),this.clickables=r,this.clickNodes=r.map((e=>e.node)),this.clickableChildren=l,this.engine=s,this.rotationMatrix=new i,this.raycaster=new t,this.click=this.click.bind(this),this.select=this.select.bind(this)}click(e){var{clickables:i,clickableChildren:t,clickNodes:r}=this;if(!0===i)c(this,a,s).call(this);else{var{raycaster:l}=this,{camera:n,renderer:o}=this.engine,h=e.clientX/o.domElement.clientWidth*2-1,d=-e.clientY/o.domElement.clientHeight*2+1;l.setFromCamera({x:h,y:d},n);var b=l.intersectObjects(r,t);c(this,a,s).call(this,b)}}select(){var e=this;return r((function*(){var{clickables:i,clickableChildren:t,clickNodes:r}=e;if(!0===i)yield c(e,a,s).call(e);else{var{raycaster:l,rotationMatrix:n}=e,{controller:o}=e.engine;n.extractRotation(o.matrixWorld),l.ray.origin.setFromMatrixPosition(o.matrixWorld),l.ray.direction.set(0,0,-1).applyMatrix4(n);var h=l.intersectObjects(r,t);yield c(e,a,s).call(e,h)}}))()}}function s(){return n.apply(this,arguments)}function n(){return n=r((function*(){var e=[];return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach((i=>{var{object:t}=i,c=this.clickables.find((e=>e.node.name===t.name));c&&e.push(c)})),yield this.engine.onTouch(e),e})),n.apply(this,arguments)}export{l as Controls};
