import{X as i,a7 as e,a1 as t,a4 as a,_ as c}from"./vendor.js";var r=new WeakSet;class l{constructor(a){var{clickables:c,clickableChildren:l=!1,engine:s}=a;i(this,r),this.clickables=c,this.clickNodes=c.map((i=>i.node)),this.clickableChildren=l,this.engine=s,this.rotationMatrix=new e,this.raycaster=new t,this.click=this.click.bind(this),this.select=this.select.bind(this)}click(i){var{clickables:e,clickableChildren:t,clickNodes:c}=this;if(!0===e)a(this,r,s).call(this);else{var{raycaster:l}=this,{camera:n,renderer:o}=this.engine,h=i.clientX/o.domElement.clientWidth*2-1,d=-i.clientY/o.domElement.clientHeight*2+1;l.setFromCamera({x:h,y:d},n);var k=l.intersectObjects(c,t);a(this,r,s).call(this,k)}}select(){var i=this;return c((function*(){var{clickables:e,clickableChildren:t,clickNodes:c}=i;if(!0===e)yield a(i,r,s).call(i);else{var{raycaster:l,rotationMatrix:n}=i,{controller:o}=i.engine;n.extractRotation(o.matrixWorld),l.ray.origin.setFromMatrixPosition(o.matrixWorld),l.ray.direction.set(0,0,-1).applyMatrix4(n);var h=l.intersectObjects(c,t);yield a(i,r,s).call(i,h)}}))()}}function s(){return n.apply(this,arguments)}function n(){return n=c((function*(){var i=[];return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach((e=>{var{object:t}=e,a=this.clickables.find((i=>i.node.name===t.name));a&&i.push(a)})),yield this.engine.onTouch(i),i})),n.apply(this,arguments)}export{l as Controls};
