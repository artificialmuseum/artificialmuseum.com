import{S as e,J as o,D as i}from"../vendor.js";class t extends e{constructor(e){var{config:t}=e,c=o(t,{startTime:1,resolution:{x:32,y:32},materialSpeed:1});super({side:i,transparent:!0,uniforms:{uTime:{value:c.startTime,type:"f"},uRes:{value:c.resolution,type:"f2"},uNormalTex:{type:"t",value:null},uColorTex:{type:"t",value:null}},vertexShader:"#define GLSLIFY 1\nuniform float uTime;float r;float PI=3.1415926538;const vec3 origin=vec3(0.,1.5,-5.);varying vec3 vPos;out vec4 clipPos;varying vec2 vUv;vec3 mod289(vec3 x){return x-floor(x*(1.0/289.0))*289.0;}vec2 mod289(vec2 x){return x-floor(x*(1.0/289.0))*289.0;}vec3 permute(vec3 x){return mod289(((x*34.0)+10.0)*x);}float snoise(vec2 v){const vec4 C=vec4(0.211324865405187,0.366025403784439,-0.577350269189626,0.024390243902439);vec2 i=floor(v+dot(v,C.yy));vec2 x0=v-i+dot(i,C.xx);vec2 i1;i1=(x0.x>x0.y)? vec2(1.0,0.0): vec2(0.0,1.0);vec4 x12=x0.xyxy+C.xxzz;x12.xy-=i1;i=mod289(i);vec3 p=permute(permute(i.y+vec3(0.0,i1.y,1.0))+i.x+vec3(0.0,i1.x,1.0));vec3 m=max(0.5-vec3(dot(x0,x0),dot(x12.xy,x12.xy),dot(x12.zw,x12.zw)),0.0);m=m*m;m=m*m;vec3 x=2.0*fract(p*C.www)-1.0;vec3 h=abs(x)-0.5;vec3 ox=floor(x+0.5);vec3 a0=x-ox;m*=1.79284291400159-0.85373472095314*(a0*a0+h*h);vec3 g;g.x=a0.x*x0.x+h.x*x0.y;g.yz=a0.yz*x12.xz+h.yz*x12.yw;return 130.0*dot(m,g);}void main(){r=snoise(vec2(uv.x+sin(uTime*.3),1.));float dist=distance(cameraPosition,origin);dist=1./dist;float canDeform=smoothstep(0.1,1.,dist)*2.;vec3 deformedVertex=position*((dist*5.)*canDeform);deformedVertex=position+(normal*((sin(PI*(66.6*dist*canDeform)*(uTime))+position.x+position.y))*r*dist*5.);vPos=deformedVertex;vPos.y=sin(PI*2.*uTime+vPos.x+vPos.y+vPos.z)*r;vPos.z=cos(PI*uTime+vPos.y+vPos.x+vPos.z)*r;vPos.x=sin(PI*uTime+vPos.z+vPos.x+vPos.y)*r;gl_Position=projectionMatrix*modelViewMatrix*vec4(deformedVertex+vPos,1.0);clipPos=gl_Position;}",fragmentShader:"#define GLSLIFY 1\nuniform float uTime;vec2 vRes;float circle;float PI=3.1415926538;in vec4 clipPos;varying vec2 vUv;vec3 color(float x){return max(min(sin(vec3(x,x+PI*2.0/3.0,x+PI*4.0/3.0))+0.5,1.0),0.0);}vec3 color2(float x){return max(min(sin(vec3(x+2.0,x+1.0,x+2.0))+1.0,1.0),0.4);}float rand(vec2 co){return fract(sin(dot(co.xy,vec2(12.9898,78.233)))*43758.5453);}float random(in vec2 _st){return fract(sin(dot(_st.xy,vec2(12.9898,78.233)))*43758.5453123);}float noise(in vec2 _st){vec2 i=floor(_st);vec2 f=fract(_st);float a=random(i);float b=random(i+vec2(1.0,0.0));float c=random(i+vec2(0.0,1.0));float d=random(i+vec2(1.0,1.0));vec2 u=f*f*(3.0-2.0*f);return mix(a,b,u.x)+(c-a)*u.y*(1.0-u.x)+(d-b)*u.x*u.y;}\n#define NUM_OCTAVES 5\nfloat fbm(in vec2 _st){float v=0.0;float a=0.5;vec2 shift=vec2(100.0);mat2 rot=mat2(cos(0.5),sin(0.5),-sin(0.5),cos(0.50));for(int i=0;i<NUM_OCTAVES;++i){v+=a*noise(_st);_st=rot*_st*2.0+shift;a*=0.5;}return v;}void main(){vec2 st=gl_FragCoord.xy/50.;vec3 color=vec3(0.0);vec2 q=vec2(0.);q.x=fbm(st+0.00*uTime);q.y=fbm(st+vec2(1.0));vec2 r=vec2(0.);r.x=fbm(st+1.0*q+vec2(1.7,9.2)+0.15*uTime);r.y=fbm(st+1.0*q+vec2(8.3,2.8)+0.126*uTime);float f=fbm(st+r);color=mix(vec3(0.101961,0.619608,0.666667),vec3(0.666667,0.666667,0.498039),clamp((f*f)*4.0,0.0,1.0));color=mix(color,vec3(0,0,0.164706),clamp(length(q),0.0,1.0));color=mix(color,vec3(0.666667,1,1),clamp(length(r.x),0.0,1.0));vec4 newC=vec4((f*f*f+.6*f*f+.5*f)*color,.6)*1.;float b=(sin(uTime*.2)+1.)*.5;vec4 colUV=vec4(vec3(vUv.x,vUv.y,b),.2);float cx=clipPos.x;float cy=clipPos.y;cx+=sin(PI*1.*uTime*cos(cy))*5.;cy+=cos(PI*1.*uTime*sin(cx))*5.;float clipColBlend=smoothstep(-cx,cx,.7);clipColBlend+=smoothstep(-cy,cy,.7);clipColBlend=1.0-clipColBlend;gl_FragColor=mix(newC,colUV,clipColBlend);}"}),this.config=c}init(e){var{node:o}=e;this.uniforms.uNormalTex.value=o.material.map,this.uniforms.uColorTex.value=o.material.map}tick(e){var{delta:o}=e;this.uniforms.uTime.value+=o*this.config.materialSpeed}}export{t as default};
